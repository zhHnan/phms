import{s as $}from"./index-BHoJcF0t.js";import{v as T,r as z,l as I,j as B,B as P,C as e,D as l,ak as n,M as u,J as A,aq as j,y as F,O as b,z as C}from"./vue-Oyw5Wt-7.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./elementPlus-BZK7s8Hm.js";const E={class:"page-container"},H=T({__name:"login",setup(J){const _=z(!1),h=z([]),o=I({userName:"",loginIp:"",status:null,dateRange:null}),s=I({page:1,size:10,total:0}),N=i=>{if(!i)return"";const t=new Date(i),r=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),m=String(t.getDate()).padStart(2,"0"),g=String(t.getHours()).padStart(2,"0"),f=String(t.getMinutes()).padStart(2,"0"),v=String(t.getSeconds()).padStart(2,"0");return`${r}-${d}-${m} ${g}:${f}:${v}`},c=async()=>{var i,t;_.value=!0;try{const r=await $.get("/log/login/page",{params:{page:s.page,size:s.size,userName:o.userName||void 0,loginIp:o.loginIp||void 0,status:o.status??void 0,startDate:((i=o.dateRange)==null?void 0:i[0])||void 0,endDate:((t=o.dateRange)==null?void 0:t[1])||void 0}});h.value=r.data.records,s.total=r.data.total}catch(r){console.error("获取登录日志失败:",r)}finally{_.value=!1}},y=()=>{s.page=1,c()},R=()=>{o.userName="",o.loginIp="",o.status=null,o.dateRange=null,y()};return B(()=>{c()}),(i,t)=>{const r=n("el-input"),d=n("el-form-item"),m=n("el-option"),g=n("el-select"),f=n("el-date-picker"),v=n("Search"),w=n("el-icon"),D=n("el-button"),Y=n("Refresh"),k=n("el-form"),S=n("el-card"),p=n("el-table-column"),V=n("el-tag"),M=n("el-table"),x=n("el-pagination"),U=j("loading");return C(),P("div",E,[e(S,{shadow:"never",class:"search-form"},{default:l(()=>[e(k,{inline:!0,model:o},{default:l(()=>[e(d,{label:"用户"},{default:l(()=>[e(r,{modelValue:o.userName,"onUpdate:modelValue":t[0]||(t[0]=a=>o.userName=a),placeholder:"请输入用户名/邮箱",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"登录IP"},{default:l(()=>[e(r,{modelValue:o.loginIp,"onUpdate:modelValue":t[1]||(t[1]=a=>o.loginIp=a),placeholder:"请输入登录IP",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"状态"},{default:l(()=>[e(g,{modelValue:o.status,"onUpdate:modelValue":t[2]||(t[2]=a=>o.status=a),placeholder:"全部状态",clearable:""},{default:l(()=>[e(m,{label:"成功",value:1}),e(m,{label:"失败",value:0})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"日期范围"},{default:l(()=>[e(f,{modelValue:o.dateRange,"onUpdate:modelValue":t[3]||(t[3]=a=>o.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[e(D,{type:"primary",onClick:y},{default:l(()=>[e(w,null,{default:l(()=>[e(v)]),_:1}),t[6]||(t[6]=u("搜索 ",-1))]),_:1}),e(D,{onClick:R},{default:l(()=>[e(w,null,{default:l(()=>[e(Y)]),_:1}),t[7]||(t[7]=u("重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(S,{shadow:"never"},{default:l(()=>[A((C(),F(M,{data:h.value,stripe:"",border:""},{default:l(()=>[e(p,{prop:"id",label:"ID",width:"80"}),e(p,{prop:"userName",label:"用户","min-width":"150"}),e(p,{prop:"userType",label:"用户类型",width:"100"},{default:l(({row:a})=>[e(V,{type:a.userType==="staff"?"primary":"success"},{default:l(()=>[u(b(a.userType==="staff"?"员工":"客户"),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"loginIp",label:"登录IP",width:"140"}),e(p,{prop:"userAgent",label:"浏览器","min-width":"200","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"80"},{default:l(({row:a})=>[e(V,{type:a.status===1?"success":"danger"},{default:l(()=>[u(b(a.status===1?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"message",label:"消息","min-width":"150","show-overflow-tooltip":""}),e(p,{prop:"createdAt",label:"登录时间",width:"180"},{default:l(({row:a})=>[u(b(N(a.createdAt)),1)]),_:1})]),_:1},8,["data"])),[[U,_.value]]),e(x,{class:"pagination","current-page":s.page,"onUpdate:currentPage":t[4]||(t[4]=a=>s.page=a),"page-size":s.size,"onUpdate:pageSize":t[5]||(t[5]=a=>s.size=a),"page-sizes":[10,20,50,100],total:s.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])]),_:1})])}}}),Q=q(H,[["__scopeId","data-v-08fcb1a2"]]);export{Q as default};
